# PianoVAM dataset defaults: paths, sampling, and target generation.
dataset:
  name: PianoVAM
  root_dir: data/PianoVAM_v1.0
  annotations_root: data/PianoVAM_v1.0
  label_format: midi
  label_targets:
    - pitch
    - onset
    - offset
    - hand
    - clef
  max_clips: 50
  manifest:
    train: data/PianoVAM_v1.0/manifest.json
    val: data/PianoVAM_v1.0/manifest.json
    test: data/PianoVAM_v1.0/manifest.json
  split: train
  split_train: train
  split_val: val
  split_test: test
  frames: 60
  decode_fps: 60.0
  hop_seconds: 0.03333333333333333
  skip_seconds: 8.0
  resize: [180, 1536]
  tiles: 3
  channels: 3
  grayscale: true
  normalize: true
  apply_crop: true
  canonical_hw: [180, 1536]
  registration:
    enable: false
    cache_path: reg_refined_pianovam.json
    source: metadata
    interp: bilinear
    global_aug:
      enabled: false
      resize_jitter: [185, 1540]
      random_crop_hw: [180, 1536]
      color_jitter:
        brightness: 0.1
        contrast: 0.1
  avlag:
    enable: false
  crop_rescale: auto
  include_low_res: false
  batch_size: 2
  num_workers: 2 # Should be 4 or more for real training
  prefetch_factor: 1 
  shuffle: true
  sampler:
    mode: onset_balanced
    onset_frac: 0.5
    nearmiss_frac: 0.25
    bg_frac: 0.25
    nearmiss_radius: 6
  require_labels: true
  frame_targets:
    enable: true
    tolerance: 0.10
    dilate_active_frames: 3 #it was one
    fill_mode: overlap
    hand_from_pitch: true
    clef_thresholds: [60, 64]
    note_min: 21
    note_max: 108
    cache_labels: false
    cache_dir: .cache/labels
    targets_sparse: true
  hand_supervision:
    enable: false
    min_confidence: 0.05
    time_tolerance: 0.05
    max_dx: 0.12
    min_points: 4
    reach:
      enable: true
      radius: 0.12
      dilate_margin: 0.02
      min_points: 4
  testing:
    canary_json: tivit/tests/resources/pianovam_canaries.json
    default_canary_count: 2
    regen_canaries: false
    enable_cache_equiv: false
    enable_audit_export: true
    audit_dir: tivit/tests/resources/audit/pianovam
    cache_off: false
    strict_sampling: false
    strict_labels: false
    strict_fallback: false
    log_level: detailed
    export_report_json: true
    report_json_path: tivit/tests/resources/audit/pianovam/model_readiness_report.jsonl
    max_event_examples: 2
    warn_fps_tolerance: 0.5
    warn_out_of_window_ratio: 0.2
    enable_debug_extras: false
